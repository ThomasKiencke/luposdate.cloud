-- TriplePattern: ?journal <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://localhost/vocabulary/bench/Journal> .
PATTERN_0 = load 'hbase://PO_S' using lupos.cloud.pig.udfs.HBaseLoadUDF('Hexa', '','<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>,<http://localhost/vocabulary/bench/Journal>', '/tmp/cloudBloomfilter_journal')as (columncontent_0:map[]);
INTERMEDIATE_BAG_0 = foreach PATTERN_0 generate flatten(lupos.cloud.pig.udfs.MapToBagUDF($0)) as (output0:chararray);

-- TriplePattern: ?journal <http://purl.org/dc/elements/1.1/title> "Journal 1 (1940)"^^<http://www.w3.org/2001/XMLSchema#string> .
PATTERN_1 = load 'hbase://PO_S' using lupos.cloud.pig.udfs.HBaseLoadUDF('Hexa', '','<http://purl.org/dc/elements/1.1/title>,"Journal 1 (1940)"^^<http://www.w3.org/2001/XMLSchema#string>', '/tmp/cloudBloomfilter_journal')as (columncontent_1:map[]);
INTERMEDIATE_BAG_1 = foreach PATTERN_1 generate flatten(lupos.cloud.pig.udfs.MapToBagUDF($0)) as (output1:chararray);

-- TriplePattern: ?journal <http://purl.org/dc/terms/issued> ?yr .
PATTERN_2 = load 'hbase://P_SO' using lupos.cloud.pig.udfs.HBaseLoadUDF('Hexa', '','<http://purl.org/dc/terms/issued>', '/tmp/cloudBloomfilter_journal', '/tmp/cloudBloomfilter_yr')  as (columncontent_2:map[]);
INTERMEDIATE_BAG_2 = foreach PATTERN_2 generate flatten(lupos.cloud.pig.udfs.MapToBagUDF($0)) as (output1_2:chararray, output2_2:chararray); 

-- Join over ?journal
INTERMEDIATE_BAG_3 = JOIN INTERMEDIATE_BAG_0 BY $0, INTERMEDIATE_BAG_1 BY $0, INTERMEDIATE_BAG_2 BY $0 PARALLEL 5;

-- Projection: ?yr
-- X = FOREACH INTERMEDIATE_BAG_3 GENERATE $3;

X = INTERMEDIATE_BAG_2;